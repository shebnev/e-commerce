# Безопасная обработка возвратов в `sales2`

## Описание

В проекте использованы **транзакций SQL** для безопасного изменения данных возвратов.
Цель — исправить некорректные значения цен у возвратов за текущий месяц и при этом **сохранить целостность данных**, используя резервное копирование и контроль изменений.

---

## Инструменты

- **SQL** — для работы с транзакциями и обновления данных;
    
- **Временные таблицы** — для резервного копирования строк перед изменениями;
    
- **Функции SQL**: `ABS()`, `DATE_FORMAT()`, `ROW_COUNT()`.

---

## Методика

1. **Создание транзакции:** `START TRANSACTION`.
    
2. **Резервное копирование данных:** создание временной таблицы с возвратами текущего месяца.
    
3. **Обновление данных:** исправление некорректных цен (`UnitPrice`) у возвратов.
    
4. **Проверка результата:** подсчёт изменённых строк с помощью `ROW_COUNT()`.
    
5. **Фиксация или откат изменений:**
    
    - `COMMIT`, если все изменения корректны.
        
    - `ROLLBACK`, если обнаружена ошибка или количество изменённых строк не соответствует ожиданиям.

## Результаты

- Все возвраты за текущий месяц были безопасно исправлены.
    
- Данные резервированы для возможного отката.
    
- Количество изменённых строк проверено перед фиксацией изменений.
